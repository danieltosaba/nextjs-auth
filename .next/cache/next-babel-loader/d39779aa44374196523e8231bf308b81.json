{"ast":null,"code":"import { compare } from \"bcrypt\";\nimport sqlite from \"sqlite\";\nexport default async function signUp(req, res) {\n  const db = await sqlite.open(\"./mydb.sqlite\");\n\n  if (req.method === \"POST\") {\n    const person = await db.get(\"SELECT password FROM person WHERE email=?\", [req.query.email]);\n    compare(req.body.password, person.password, async function (err, result) {\n      if (!err && result) {\n        res.json({\n          message: \"OK\"\n        });\n      } else {\n        res.json({\n          message: \"NOT OK\"\n        });\n      }\n    });\n  } else {\n    res.status(405).json({\n      message: \"We only support POST method\"\n    });\n  }\n}","map":{"version":3,"sources":["/Users/daniel/Documents/development/NEXTJS/nextjs-auth/src/pages/api/login.ts"],"names":["compare","sqlite","signUp","req","res","db","open","method","person","get","query","email","body","password","err","result","json","message","status"],"mappings":"AAAA,SAASA,OAAT,QAAwB,QAAxB;AAEA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,eAAe,eAAeC,MAAf,CACbC,GADa,EAEbC,GAFa,EAGb;AACA,QAAMC,EAAE,GAAG,MAAMJ,MAAM,CAACK,IAAP,CAAY,eAAZ,CAAjB;;AAEA,MAAIH,GAAG,CAACI,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAMC,MAAM,GAAG,MAAMH,EAAE,CAACI,GAAH,CAAO,2CAAP,EAAoD,CACvEN,GAAG,CAACO,KAAJ,CAAUC,KAD6D,CAApD,CAArB;AAGAX,IAAAA,OAAO,CAACG,GAAG,CAACS,IAAJ,CAASC,QAAV,EAAoBL,MAAM,CAACK,QAA3B,EAAqC,gBAAgBC,GAAhB,EAAqBC,MAArB,EAA6B;AACvE,UAAG,CAACD,GAAD,IAAQC,MAAX,EAAmB;AACfX,QAAAA,GAAG,CAACY,IAAJ,CAAS;AAACC,UAAAA,OAAO,EAAE;AAAV,SAAT;AACH,OAFD,MAEO;AACHb,QAAAA,GAAG,CAACY,IAAJ,CAAS;AAACC,UAAAA,OAAO,EAAE;AAAV,SAAT;AACH;AACF,KANM,CAAP;AAOD,GAXD,MAWO;AACLb,IAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB;AACD;AACF","sourcesContent":["import { compare } from \"bcrypt\";\nimport { NextApiRequest, NextApiResponse } from \"next\";\nimport sqlite from \"sqlite\";\n\nexport default async function signUp(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const db = await sqlite.open(\"./mydb.sqlite\");\n\n  if (req.method === \"POST\") {\n    const person = await db.get(\"SELECT password FROM person WHERE email=?\", [\n      req.query.email,\n    ]);\n    compare(req.body.password, person.password, async function (err, result) {\n      if(!err && result) {\n          res.json({message: \"OK\"});\n      } else {\n          res.json({message: \"NOT OK\"});\n      }\n    });\n  } else {\n    res.status(405).json({ message: \"We only support POST method\" });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}