{"ast":null,"code":"import { hash } from \"bcrypt\";\nimport sqlite from \"sqlite\";\nexport default async function signUp(req, res) {\n  const db = await sqlite.open(\"./mydb.sqlite\");\n\n  if (req.method === \"POST\") {\n    hash(req.body.password, 10, async function (err, hash) {\n      const statement = await db.prepare(\"INSERT INTO person (name, email, password) values(?, ?, ?)\");\n      const result = await statement.run(req.body.name, req.body.email, hash);\n      result.finalize();\n      const person = await db.all(\"select * from person\");\n      res.json(person);\n    });\n  } else {\n    res.status(405).json({\n      message: \"We only support POST method\"\n    });\n  }\n}","map":{"version":3,"sources":["/Users/daniel/Documents/development/NEXTJS/nextjs-auth/src/pages/api/signup.ts"],"names":["hash","sqlite","signUp","req","res","db","open","method","body","password","err","statement","prepare","result","run","name","email","finalize","person","all","json","status","message"],"mappings":"AAAA,SAASA,IAAT,QAAqB,QAArB;AAEA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,eAAe,eAAeC,MAAf,CACbC,GADa,EAEbC,GAFa,EAGb;AACA,QAAMC,EAAE,GAAG,MAAMJ,MAAM,CAACK,IAAP,CAAY,eAAZ,CAAjB;;AAEA,MAAIH,GAAG,CAACI,MAAJ,KAAe,MAAnB,EAA2B;AACzBP,IAAAA,IAAI,CAACG,GAAG,CAACK,IAAJ,CAASC,QAAV,EAAoB,EAApB,EAAwB,gBAAgBC,GAAhB,EAAqBV,IAArB,EAA2B;AACrD,YAAMW,SAAS,GAAG,MAAMN,EAAE,CAACO,OAAH,CACtB,4DADsB,CAAxB;AAGA,YAAMC,MAAM,GAAG,MAAMF,SAAS,CAACG,GAAV,CAAcX,GAAG,CAACK,IAAJ,CAASO,IAAvB,EAA6BZ,GAAG,CAACK,IAAJ,CAASQ,KAAtC,EAA6ChB,IAA7C,CAArB;AACAa,MAAAA,MAAM,CAACI,QAAP;AAEA,YAAMC,MAAM,GAAG,MAAMb,EAAE,CAACc,GAAH,CAAO,sBAAP,CAArB;AACAf,MAAAA,GAAG,CAACgB,IAAJ,CAASF,MAAT;AACD,KATG,CAAJ;AAUD,GAXD,MAWO;AACLd,IAAAA,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqB;AAAEE,MAAAA,OAAO,EAAE;AAAX,KAArB;AACD;AACF","sourcesContent":["import { hash } from \"bcrypt\";\nimport { NextApiRequest, NextApiResponse } from \"next\";\nimport sqlite from \"sqlite\";\n\nexport default async function signUp(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const db = await sqlite.open(\"./mydb.sqlite\");\n\n  if (req.method === \"POST\") {\n    hash(req.body.password, 10, async function (err, hash) {\n      const statement = await db.prepare(\n        \"INSERT INTO person (name, email, password) values(?, ?, ?)\"\n      );\n      const result = await statement.run(req.body.name, req.body.email, hash);\n      result.finalize();\n\n      const person = await db.all(\"select * from person\");\n      res.json(person);\n    });\n  } else {\n    res.status(405).json({ message: \"We only support POST method\" });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}